<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Póster 1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      height: 100%;
      background: url('../Imagenes/fondoposters.png') no-repeat center center fixed;
      background-size: cover;
      overflow-x: hidden;
      touch-action: none;
    }

    .boton-retroceder,
    .boton-home {
      position: fixed;
      width: 120px;
      height: 130px;
      font-size: 2.5em;
      border: none;
      border-radius: 50%;
      background: rgba(243, 0, 0, 0.9);
      color: black;
      cursor: pointer;
      z-index: 20;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s, background-color 0.3s;
      opacity: 0;
    }

    .boton-retroceder {
      top: 60px;
      left: 50px;
    }

    .boton-home {
      top: 70px;
      right: 80px;
    }

    .boton-retroceder:hover,
    .boton-home:hover {
      background-color: #ff0000;
      color: white;
      transform: scale(1.1);
    }

    .container {
      margin-top: 220px;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      height: calc(100vh - 200px);
    }

    .poster-imagen {
      max-width: 100vw;
      max-height: 80vh;
      border: 4px solid white;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
      object-fit: contain;
      transition: transform 0.2s ease;
      z-index: 1;
      touch-action: none;
      cursor: grab;
    }
  </style>
</head>

<body>
  <!-- Botones navegación -->
  <button class="boton-retroceder" onclick="window.location.href='../posters.html'">←</button>
  <button class="boton-home" onclick="window.location.href='../index.html'">⌂</button>
  
  <!-- Contenedor principal -->
  <div class="container">
    <img id="poster" class="poster-imagen" src="../Imagenes/poster03.png" alt="Póster 1">
  </div>

  <script>
    const img = document.getElementById('poster');
    let scale = 1;
    let originX = 50;
    let originY = 50;
    let lastTap = 0;
    let zoomEnabled = true;

    let isDragging = false;
    let dragStartX = 0;
    let dragStartY = 0;
    let currentX = 0;
    let currentY = 0;

    // Zoom y arrastre
    function updateZoom() {
      const container = img.parentElement.getBoundingClientRect();
      const imgDisplayWidth = img.clientWidth;
      const imgDisplayHeight = img.clientHeight;

      const scaledWidth = imgDisplayWidth * scale;
      const scaledHeight = imgDisplayHeight * scale;

      const maxX = Math.max((scaledWidth - container.width) / 2, 0);
      const maxY = Math.max((scaledHeight - container.height) / 2, 0);

      currentX = Math.min(maxX, Math.max(-maxX, currentX));
      currentY = Math.min(maxY, Math.max(-maxY, currentY));

      img.style.transformOrigin = `${originX}% ${originY}%`;
      img.style.transform = `scale(${scale}) translate(${currentX}px, ${currentY}px)`;
    }

    function resetZoom() {
      scale = 1;
      originX = 50;
      originY = 50;
      currentX = 0;
      currentY = 0;
      updateZoom();
    }

    function zoomAt(x, y, zoomFactor) {
      const rect = img.getBoundingClientRect();
      const offsetX = x - rect.left;
      const offsetY = y - rect.top;
      originX = (offsetX / rect.width) * 100;
      originY = (offsetY / rect.height) * 100;
      scale = zoomFactor;
      currentX = 0;
      currentY = 0;
      updateZoom();
    }

    img.onclick = (e) => {
      const now = Date.now();
      if (!zoomEnabled) return;
      if (now - lastTap < 300) {
        scale = scale === 1 ? 2 : 1;
        zoomAt(e.clientX, e.clientY, scale);
      }
      lastTap = now;
    };

    img.ontouchend = (e) => {
      const now = Date.now();
      if (!zoomEnabled) return;
      if (now - lastTap < 300 && e.changedTouches.length === 1) {
        const touch = e.changedTouches[0];
        scale = scale === 1 ? 2 : 1;
        zoomAt(touch.clientX, touch.clientY, scale);
      }
      lastTap = now;
    };

    img.onwheel = (e) => {
      if (!zoomEnabled) return;
      e.preventDefault();
      const delta = e.deltaY > 0 ? -0.1 : 0.1;
      scale += delta;
      scale = Math.max(1, Math.min(3, scale));
      originX = 50;
      originY = 50;
      currentX = 0;
      currentY = 0;
      updateZoom();
    };

    img.onmousedown = (e) => {
      if (scale === 1) return;
      isDragging = true;
      dragStartX = e.clientX;
      dragStartY = e.clientY;
      img.style.cursor = "grabbing";
    };

    img.onmousemove = (e) => {
      if (!isDragging) return;
      const dx = e.clientX - dragStartX;
      const dy = e.clientY - dragStartY;
      dragStartX = e.clientX;
      dragStartY = e.clientY;
      currentX += dx;
      currentY += dy;
      updateZoom();
    };

    img.onmouseup = () => {
      isDragging = false;
      img.style.cursor = "grab";
    };

    img.onmouseleave = () => {
      isDragging = false;
      img.style.cursor = "grab";
    };

    img.ontouchstart = (e) => {
      if (scale === 1 || e.touches.length !== 1) return;
      isDragging = true;
      const touch = e.touches[0];
      dragStartX = touch.clientX;
      dragStartY = touch.clientY;
    };

    img.ontouchmove = (e) => {
      if (!isDragging || e.touches.length !== 1) return;
      const touch = e.touches[0];
      const dx = touch.clientX - dragStartX;
      const dy = touch.clientY - dragStartY;
      dragStartX = touch.clientX;
      dragStartY = touch.clientY;
      currentX += dx;
      currentY += dy;
      updateZoom();
    };

    img.ontouchend = () => {
      isDragging = false;
    };

    // Swipe táctil para galería
    let touchStartX = 0;
    let touchEndX = 0;

    document.addEventListener('touchstart', function (e) {
      if (e.touches.length === 1) {
        touchStartX = e.touches[0].clientX;
      }
    });

    document.addEventListener('touchend', function (e) {
      if (e.changedTouches.length === 1) {
        touchEndX = e.changedTouches[0].clientX;
        handleSwipe();
      }
    });

    function handleSwipe() {
      const deltaX = touchEndX - touchStartX;
      if (deltaX > 50) {
        window.location.href = 'poster2.html'; // ← Anterior
      } else if (deltaX < -50) {
        window.location.href = 'poster1.html'; // → Siguiente
      }
    }

    resetZoom();
  </script>
</body>
</html>
